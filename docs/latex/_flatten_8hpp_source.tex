\doxysection{Flatten.\+hpp}
\hypertarget{_flatten_8hpp_source}{}\label{_flatten_8hpp_source}\index{src/NeuralNet/layers/Flatten.hpp@{src/NeuralNet/layers/Flatten.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <tuple>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <cereal/cereal.hpp>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <cereal/types/polymorphic.hpp>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <cereal/archives/portable\_binary.hpp>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <cereal/archives/binary.hpp>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <cereal/access.hpp>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <cereal/types/base\_class.hpp>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}Layer.hpp"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}utils/Functions.hpp"{}}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}utils/Serialize.hpp"{}}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{namespace\ }NeuralNet}
\DoxyCodeLine{00015\ \{}
\DoxyCodeLine{00016\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_neural_net_1_1_flatten}{Flatten}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_neural_net_1_1_layer}{Layer}}}
\DoxyCodeLine{00017\ \ \ \{}
\DoxyCodeLine{00018\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00026\ \ \ \ \ \mbox{\hyperlink{class_neural_net_1_1_flatten_a58993cf3bbad91fb4f3dc4570278e82c}{Flatten}}(std::tuple<int,\ int>\ inputShape)\ :\ \mbox{\hyperlink{class_neural_net_1_1_layer}{Layer}}(inputShape),\ inputShape(inputShape)}
\DoxyCodeLine{00027\ \ \ \ \ \{}
\DoxyCodeLine{00028\ \ \ \ \ \ \ type\ =\ LayerType::FLATTEN;}
\DoxyCodeLine{00029\ \ \ \ \ \};}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00037\ \ \ \ \ Eigen::MatrixXd\ \mbox{\hyperlink{class_neural_net_1_1_flatten_a715f3cb27e42842f4ac5fd10c67f3028}{flatten}}(std::vector<std::vector<std::vector<double>>>\ inputs)}
\DoxyCodeLine{00038\ \ \ \ \ \{}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ rows\ =\ std::get<0>(inputShape);}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ cols\ =\ std::get<1>(inputShape);}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \ \ \textcolor{comment}{//\ Flatten\ the\ vectors}}
\DoxyCodeLine{00043\ \ \ \ \ \ \ std::vector<double>\ flatInputs;}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ std::vector<std::vector<double>>\ \&input\ :\ inputs)}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ std::vector<double>\ flattenedInput\ =\ flatten2DVector(input,\ rows,\ cols);}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ flatInputs.insert(flatInputs.end(),\ flattenedInput.begin(),\ flattenedInput.end());}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ numRows\ =\ inputs.size();}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ numCols\ =\ rows\ *\ cols;}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Eigen::Map<Eigen::Matrix<double,\ Eigen::Dynamic,\ Eigen::Dynamic,\ Eigen::RowMajor>>(flatInputs.data(),\ numRows,\ numCols);}
\DoxyCodeLine{00053\ \ \ \ \ \};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \mbox{\hyperlink{class_neural_net_1_1_flatten}{\string~Flatten}}()\{\};}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{comment}{//\ non-\/public\ serialization}}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }cereal::access;}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ Flatten()\{\};\ \textcolor{comment}{//\ Necessary\ for\ serialization}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \ \ std::tuple<int,\ int>\ inputShape;}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ Archive>}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordtype}{void}\ serialize(Archive\ \&ar)}
\DoxyCodeLine{00067\ \ \ \ \ \{}
\DoxyCodeLine{00068\ \ \ \ \ \ \ ar(cereal::base\_class<Layer>(\textcolor{keyword}{this}),\ inputShape);}
\DoxyCodeLine{00069\ \ \ \ \ \}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordtype}{void}\ feedInputs(std::vector<std::vector<std::vector<double>>>\ inputs)}
\DoxyCodeLine{00072\ \ \ \ \ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ Eigen::MatrixXd\ flattenedInputs\ =\ this-\/>\mbox{\hyperlink{class_neural_net_1_1_flatten_a715f3cb27e42842f4ac5fd10c67f3028}{flatten}}(inputs);}
\DoxyCodeLine{00074\ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{class_neural_net_1_1_layer_ae81f8d543115f7be083f2a57d9baa551}{setOutputs}}(flattenedInputs);}
\DoxyCodeLine{00075\ \ \ \ \ \}}
\DoxyCodeLine{00076\ \ \ \};}
\DoxyCodeLine{00077\ \}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \textcolor{keyword}{namespace\ }cereal}
\DoxyCodeLine{00080\ \{}
\DoxyCodeLine{00081\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ Archive>}
\DoxyCodeLine{00082\ \ \ \textcolor{keyword}{struct\ }specialize<Archive,\ NeuralNet::Flatten,\ cereal::specialization::member\_serialize>}
\DoxyCodeLine{00083\ \ \ \{}
\DoxyCodeLine{00084\ \ \ \};}
\DoxyCodeLine{00085\ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ CEREAL\_REGISTER\_TYPE(\mbox{\hyperlink{class_neural_net_1_1_flatten}{NeuralNet::Flatten}});}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ CEREAL\_REGISTER\_POLYMORPHIC\_RELATION(\mbox{\hyperlink{class_neural_net_1_1_layer}{NeuralNet::Layer}},\ \mbox{\hyperlink{class_neural_net_1_1_flatten}{NeuralNet::Flatten}});}

\end{DoxyCode}
