\doxysection{Layer.\+hpp}
\hypertarget{_layer_8hpp_source}{}\label{_layer_8hpp_source}\index{src/NeuralNet/layers/Layer.hpp@{src/NeuralNet/layers/Layer.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <cstdlib>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <random>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <tuple>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <cereal/access.hpp>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <cereal/types/common.hpp>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <cereal/types/base\_class.hpp>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <cereal/types/polymorphic.hpp>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <cereal/archives/portable\_binary.hpp>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <cereal/archives/binary.hpp>}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <Eigen/Dense>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}utils/Functions.hpp"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}utils/Serialize.hpp"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}utils/Enums.hpp"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}activations/activations.hpp"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}Network.hpp"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{keyword}{namespace\ }NeuralNet}
\DoxyCodeLine{00022\ \{}
\DoxyCodeLine{00023\ \ \ \textcolor{comment}{//\ Should\ be\ updated\ when\ a\ new\ layer\ type\ is\ added}}
\DoxyCodeLine{00024\ \ \ \textcolor{keyword}{enum\ class}\ LayerType}
\DoxyCodeLine{00025\ \ \ \{}
\DoxyCodeLine{00026\ \ \ \ \ DEFAULT,}
\DoxyCodeLine{00027\ \ \ \ \ DENSE,}
\DoxyCodeLine{00028\ \ \ \ \ FLATTEN}
\DoxyCodeLine{00029\ \ \ \};}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_neural_net_1_1_layer}{Layer}}}
\DoxyCodeLine{00032\ \ \ \{}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_neural_net_1_1_network}{Network}};}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00036\ \ \ \ \ \mbox{\hyperlink{class_neural_net_1_1_layer}{Layer}}(\textcolor{keywordtype}{int}\ nNeurons,\ ACTIVATION\ activation\ =\ ACTIVATION::SIGMOID,\ WEIGHT\_INIT\ weightInit\ =\ WEIGHT\_INIT::RANDOM,\ \textcolor{keywordtype}{int}\ bias\ =\ 0)}
\DoxyCodeLine{00037\ \ \ \ \ \{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ this-\/>bias\ =\ bias;}
\DoxyCodeLine{00039\ \ \ \ \ \ \ this-\/>nNeurons\ =\ nNeurons;}
\DoxyCodeLine{00040\ \ \ \ \ \ \ this-\/>weightInit\ =\ weightInit;}
\DoxyCodeLine{00041\ \ \ \ \ \ \ this-\/>activation\ =\ activation;}
\DoxyCodeLine{00042\ \ \ \ \ \ \ this-\/>setActivation(activation);}
\DoxyCodeLine{00043\ \ \ \ \ \};}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_neural_net_1_1_layer_afa59ddacc5796712e5061ed055833fde}{getNumNeurons}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00051\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ nNeurons;}
\DoxyCodeLine{00053\ \ \ \ \ \};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00060\ \ \ \ \ Eigen::MatrixXd\ \mbox{\hyperlink{class_neural_net_1_1_layer_ac6448e3a5415b1ea351ca22fa2b895a0}{getWeights}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00061\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ weights;}
\DoxyCodeLine{00063\ \ \ \ \ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00070\ \ \ \ \ Eigen::MatrixXd\ \mbox{\hyperlink{class_neural_net_1_1_layer_a296c21f474dbe7fc2926a5e0b7ab87aa}{getBiases}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00071\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ biases;}
\DoxyCodeLine{00073\ \ \ \ \ \}}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00080\ \ \ \ \ Eigen::MatrixXd\ \mbox{\hyperlink{class_neural_net_1_1_layer_a1b86e971a93bed55690ecf1840207c34}{getOutputs}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00081\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ outputs;}
\DoxyCodeLine{00083\ \ \ \ \ \};}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_neural_net_1_1_layer_a7e41c0fcc3f9e8fdf2ce506547670846}{printWeights}}()}
\DoxyCodeLine{00089\ \ \ \ \ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ std::cout\ <<\ this-\/>weights\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00092\ \ \ \ \ \};}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_neural_net_1_1_layer_ab2b004ab5c1bb057f4ca568b55a47ef4}{printOutputs}}()}
\DoxyCodeLine{00098\ \ \ \ \ \{}
\DoxyCodeLine{00099\ \ \ \ \ \ \ std::cout\ <<\ this-\/>outputs\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00101\ \ \ \ \ \};}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \mbox{\hyperlink{class_neural_net_1_1_layer}{\string~Layer}}()\{\};}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{comment}{//\ non-\/public\ serialization}}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }cereal::access;}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordtype}{double}\ bias;}
\DoxyCodeLine{00110\ \ \ \ \ Eigen::MatrixXd\ biases;}
\DoxyCodeLine{00111\ \ \ \ \ WEIGHT\_INIT\ weightInit;}
\DoxyCodeLine{00112\ \ \ \ \ Eigen::MatrixXd\ outputs;}
\DoxyCodeLine{00113\ \ \ \ \ Eigen::MatrixXd\ weights;}
\DoxyCodeLine{00114\ \ \ \ \ Eigen::MatrixXd\ cachedWeights;}
\DoxyCodeLine{00115\ \ \ \ \ Eigen::MatrixXd\ cachedBiases;}
\DoxyCodeLine{00116\ \ \ \ \ ACTIVATION\ activation;}
\DoxyCodeLine{00117\ \ \ \ \ Eigen::MatrixXd\ (*activate)(\textcolor{keyword}{const}\ Eigen::MatrixXd\ \&);}
\DoxyCodeLine{00118\ \ \ \ \ Eigen::MatrixXd\ (*diff)(\textcolor{keyword}{const}\ Eigen::MatrixXd\ \&);}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordtype}{void}\ init(\textcolor{keywordtype}{int}\ numRows)}
\DoxyCodeLine{00125\ \ \ \ \ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \textcolor{comment}{//\ First\ and\ foremost\ init\ the\ biases\ and\ the\ outputs}}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ mean\ =\ 0,\ stddev\ =\ 0;}
\DoxyCodeLine{00128\ \ \ \ \ \ \ this-\/>weights\ =\ Eigen::MatrixXd::Zero(numRows,\ nNeurons);}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ going\ to\ be\ used\ for\ testing}}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>weightInit\ ==\ WEIGHT\_INIT::CONSTANT)}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ this-\/>weights\ =\ Eigen::MatrixXd::Constant(numRows,\ nNeurons,\ 1);}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \ \ \ \ \textcolor{comment}{//\ calculate\ mean\ and\ stddev\ based\ on\ init\ algo}}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (this-\/>weightInit)}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ WEIGHT\_INIT::GLOROT:}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ sqrt(fan\_avg)}}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ stddev\ =\ sqrt(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(2)\ /\ (numRows\ +\ nNeurons));}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ WEIGHT\_INIT::HE:}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ sqrt(2/fan\_in)}}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ stddev\ =\ sqrt(2.0\ /\ numRows);}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ WEIGHT\_INIT::LECUN:}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ sqrt(1/fan\_in)}}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ stddev\ =\ sqrt(1.0\ /\ numRows);}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ \ \ \textcolor{comment}{//\ Init\ the\ weights}}
\DoxyCodeLine{00157\ \ \ \ \ \ \ this-\/>weightInit\ ==\ WEIGHT\_INIT::RANDOM\ ?\ randomWeightInit(\&(this-\/>weights),\ -\/1,\ 1)\ :\ randomDistMatrixInit(\&(this-\/>weights),\ mean,\ stddev);}
\DoxyCodeLine{00158\ \ \ \ \ \}}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keyword}{virtual}\ Eigen::MatrixXd\ feedInputs(std::vector<double>\ inputs)}
\DoxyCodeLine{00168\ \ \ \ \ \{}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>feedInputs(Eigen::MatrixXd::Map(\&inputs[0],\ inputs.size(),\ 1));}
\DoxyCodeLine{00170\ \ \ \ \ \};}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keyword}{virtual}\ Eigen::MatrixXd\ feedInputs(Eigen::MatrixXd\ inputs)}
\DoxyCodeLine{00180\ \ \ \ \ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \textcolor{comment}{//\ Layer\ is\ "{}input"{}\ layer}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (weights.rows()\ ==\ 0)}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{class_neural_net_1_1_layer_ae81f8d543115f7be083f2a57d9baa551}{setOutputs}}(inputs);}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ inputs;}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \ \ \ \ inputs\ =\ inputs.cols()\ ==\ weights.rows()\ ?\ inputs\ :\ inputs.transpose();}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \ \ \ \ assert(inputs.cols()\ ==\ weights.rows());}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>computeOutputs(inputs);}
\DoxyCodeLine{00192\ \ \ \ \ \};}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ feedInputs(std::vector<std::vector<std::vector<double>>>\ inputs)}
\DoxyCodeLine{00202\ \ \ \ \ \{}
\DoxyCodeLine{00203\ \ \ \ \ \ \ assert(\textcolor{keyword}{false}\ \&\&\ \textcolor{stringliteral}{"{}Cannot\ feed\ 3d\ vectors,\ a\ Flatten\ layer\ could\ do\ it\ though"{}});}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00205\ \ \ \ \ \};}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00214\ \ \ \ \ Eigen::MatrixXd\ computeOutputs(Eigen::MatrixXd\ inputs)}
\DoxyCodeLine{00215\ \ \ \ \ \{}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \textcolor{comment}{//\ Initialize\ the\ biases\ based\ on\ the\ input's\ size}}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (biases.rows()\ ==\ 0\ \&\&\ biases.cols()\ ==\ 0)}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ biases\ =\ Eigen::MatrixXd::Constant(1,\ nNeurons,\ bias);}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \ \ \ \ \ \ \textcolor{comment}{//\ Weighted\ sum}}
\DoxyCodeLine{00223\ \ \ \ \ \ \ Eigen::MatrixXd\ wSum\ =\ inputs\ *\ weights;}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \ \ \ \ wSum.rowwise()\ +=\ biases.row(0);}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \ \ \ \ outputs\ =\ activate(wSum);}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ outputs;}
\DoxyCodeLine{00229\ \ \ \ \ \};}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00238\ \ \ \ \ \textcolor{keywordtype}{void}\ setActivation(ACTIVATION\ activation)}
\DoxyCodeLine{00239\ \ \ \ \ \{}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ ==\ LayerType::FLATTEN)}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ this-\/>activate\ =\ \mbox{\hyperlink{class_neural_net_1_1_activation_a2f6758fa2bb12c32cf5c02bff19c2864}{Activation::activate}};}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ this-\/>diff\ =\ \mbox{\hyperlink{class_neural_net_1_1_activation_a14c8727d059ff60ff1a4aef683910ab1}{Activation::diff}};}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (activation)}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ACTIVATION::SIGMOID:}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ this-\/>activate\ =\ Sigmoid::activate;}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ this-\/>diff\ =\ Sigmoid::diff;}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ACTIVATION::RELU:}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ this-\/>activate\ =\ Relu::activate;}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ this-\/>diff\ =\ Relu::diff;}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ACTIVATION::SOFTMAX:}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ this-\/>activate\ =\ Softmax::activate;}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ this-\/>diff\ =\ Softmax::diff;}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ assert(\textcolor{keyword}{false}\ \&\&\ \textcolor{stringliteral}{"{}Activation\ not\ defined"{}});}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00269\ \ \ \ \ \};}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{comment}{//\ Necessary\ function\ for\ serializing\ Layer}}
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ Archive>}
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{keywordtype}{void}\ save(Archive\ \&archive)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00274\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00275\ \ \ \ \ \ \ archive(nNeurons,\ weights,\ outputs,\ biases,\ activation,\ type);}
\DoxyCodeLine{00276\ \ \ \ \ \};}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ Archive>}
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{keywordtype}{void}\ load(Archive\ \&archive)}
\DoxyCodeLine{00280\ \ \ \ \ \{}
\DoxyCodeLine{00281\ \ \ \ \ \ \ archive(nNeurons,\ weights,\ outputs,\ biases,\ activation,\ type);}
\DoxyCodeLine{00282\ \ \ \ \ \ \ setActivation(activation);}
\DoxyCodeLine{00283\ \ \ \ \ \}}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00285\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00286\ \ \ \ \ Layer()\{\};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Necessary\ for\ serialization}}
\DoxyCodeLine{00287\ \ \ \ \ Layer(std::tuple<int,\ int>\ inputShape)\ :\ nNeurons(std::get<0>(inputShape)\ *\ std::get<1>(inputShape))\{\};\ \textcolor{comment}{//\ Used\ in\ Flatten\ layer}}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{keywordtype}{int}\ nNeurons;\ \textcolor{comment}{//\ Number\ of\ neurons}}
\DoxyCodeLine{00290\ \ \ \ \ LayerType\ type\ =\ LayerType::DEFAULT;}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00301\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_neural_net_1_1_layer_ae81f8d543115f7be083f2a57d9baa551}{setOutputs}}(std::vector<double>\ outputs)}
\DoxyCodeLine{00302\ \ \ \ \ \{}
\DoxyCodeLine{00303\ \ \ \ \ \ \ assert(outputs.size()\ ==\ nNeurons);}
\DoxyCodeLine{00304\ \ \ \ \ \ \ this-\/>outputs\ =\ Eigen::MatrixXd\ ::Map(\&outputs[0],\ this-\/>\mbox{\hyperlink{class_neural_net_1_1_layer_afa59ddacc5796712e5061ed055833fde}{getNumNeurons}}(),\ 1);}
\DoxyCodeLine{00305\ \ \ \ \ \};}
\DoxyCodeLine{00306\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_neural_net_1_1_layer_ae81f8d543115f7be083f2a57d9baa551}{setOutputs}}(Eigen::MatrixXd\ outputs)\ \textcolor{comment}{//\ used\ for\ the\ Flatten\ Layer}}
\DoxyCodeLine{00307\ \ \ \ \ \{}
\DoxyCodeLine{00308\ \ \ \ \ \ \ this-\/>outputs\ =\ outputs;}
\DoxyCodeLine{00309\ \ \ \ \ \};}
\DoxyCodeLine{00310\ \ \ \};}
\DoxyCodeLine{00311\ \}}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00313\ CEREAL\_REGISTER\_TYPE(\mbox{\hyperlink{class_neural_net_1_1_layer}{NeuralNet::Layer}});}

\end{DoxyCode}
